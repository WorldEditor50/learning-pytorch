# pytorch note

## 1. 数据加载
- 按照图像类别存放图像数据
- 遍历图像文件，使用数字编码类别标签
- 保存图像路径与类别标签进cvs文件
- 实现数据索引类，支持获取数据集长度、随机获取图像和标签数据 、缩放图像尺寸、旋转图像、转换Tensor数据
- 使用torch DataLoader类加载数据
- 分割数据集为训练集、验证集和测试集，训练集数据需要乱序

## 2. 卷积网络模型搭建
- 模型选择: 分类问题选择resnet, 目标检测选择yolo, 分割问题选择u-net
- 确定层级输入输出通道，按照网络结构复现
- 设置输入参数执行forward, 确保层级衔接正确
- 打印层结构与模型结构有助于理解模型与发现问题
- 迁移学习：
    - 使用pytorch自带的模型
    - 设置使用预训练参数
    - 展平输出层，添加层转换分类维度

## 3. 训练
- 模型训练四部曲：向前计算 => 计算误差损失 => 反向传播误差并计算梯度 => 更新梯度
- 选择损失函数
- 选择优化器
- 验证数据集中计算精度，保存最优精度参数
- 测试数据集中计算精度评估模型效果

## 4. 推理部署
- pytorch模型转换onnx
- 编译安装opencv、protobuf、ncnn
- 使用ncnn搭建推理模型
